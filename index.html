<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cephe HattÄ±: Ä°stiklal</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #2b2b2b;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
        }
        #gameCanvas {
            border: 5px solid #3e2723;
            background-color: #d7ccc8;
            cursor: crosshair;
            box-shadow: 0 0 30px rgba(0,0,0,0.7);
        }
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #3e2723;
            pointer-events: none;
        }
        #startScreen, #gameOverScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            background: rgba(62, 39, 35, 0.95);
            padding: 40px;
            border: 2px solid #a1887f;
            border-radius: 5px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            min-width: 300px;
        }
        h1 { color: #d7ccc8; margin-top: 0; text-transform: uppercase; letter-spacing: 2px; }
        p { color: #efebe9; font-size: 18px; }
        button {
            background-color: #a1887f;
            color: #3e2723;
            border: none;
            padding: 15px 30px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: 0.3s;
        }
        button:hover { background-color: #d7ccc8; }

        /* Spotify embed player */
        #spotifyPlayer {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body>

    <div id="ui">ðŸ‡¹ðŸ‡· DÃ¼ÅŸman KaybÄ±: <span id="score">0</span></div>
    <canvas id="gameCanvas"></canvas>

    <div id="startScreen">
        <h1>MÃœDAFAA HATTI</h1>
        <p>Vatan savunmasÄ± iÃ§in hazÄ±r mÄ±sÄ±n?</p>
        <p>Hareket: W, A, S, D <br> AteÅŸ: Mouse Sol TÄ±k</p>
        <button onclick="startGame()">CEPHEYE GÄ°T</button>
    </div>

    <div id="gameOverScreen" style="display: none;">
        <h1 style="color: #e57373;">ÅžEHÄ°T DÃœÅžTÃœNÃœZ</h1>
        <p>Vatan size minnettar.</p>
        <p>Toplam Etkisiz Hale Getirilen DÃ¼ÅŸman: <span id="finalScore">0</span></p>
        <button onclick="restartGame()">YENÄ°DEN DÄ°RÄ°LÄ°Åž</button>
    </div>

    <!-- Spotify Embed -->
    <div id="spotifyPlayer">
        <iframe src="https://open.spotify.com/embed/track/5rZM6T0xlVUNjtPzukVbSj" width="300" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const finalScoreEl = document.getElementById('finalScore');
    const startScreen = document.getElementById('startScreen');
    const gameOverScreen = document.getElementById('gameOverScreen');
    const spotifyPlayer = document.getElementById('spotifyPlayer');

    canvas.width = window.innerWidth - 20;
    canvas.height = window.innerHeight - 20;

    let score = 0;
    let gameRunning = false;
    let animationId;

    function drawTurkAskeri(ctx, x, y, radius, angle) {
        ctx.save();
        ctx.translate(x, y);
        ctx.rotate(angle);
        ctx.fillStyle = '#4B5320'; 
        ctx.beginPath(); ctx.ellipse(0, 0, radius, radius * 0.6, 0, 0, Math.PI * 2); ctx.fill();
        ctx.strokeStyle = '#3E2723'; ctx.lineWidth = 2;
        ctx.beginPath(); ctx.moveTo(-radius/2, -radius/2); ctx.lineTo(radius/2, radius/2); ctx.stroke();
        ctx.fillStyle = '#ffdbac'; 
        ctx.beginPath(); ctx.arc(0, 0, radius * 0.6, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#2F3515'; 
        ctx.beginPath(); ctx.arc(0, 0, radius * 0.65, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#1a1f0d'; 
        ctx.beginPath(); ctx.arc(0, 0, radius * 0.3, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#111'; ctx.fillRect(radius * 0.5, -2, radius, 4);
        ctx.restore();
    }

    function drawDusmanAskeri(ctx, x, y, radius, angle) {
        ctx.save();
        ctx.translate(x, y);
        ctx.rotate(angle);
        ctx.fillStyle = '#4682B4'; 
        ctx.beginPath(); ctx.ellipse(0, 0, radius, radius * 0.6, 0, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#ffdbac'; 
        ctx.beginPath(); ctx.arc(0, 0, radius * 0.6, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#708090'; 
        ctx.beginPath(); ctx.arc(0, 0, radius * 0.65, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#555'; ctx.fillRect(radius * 0.4, -2, radius * 0.8, 4);
        ctx.restore();
    }

    class Player {
        constructor(x, y) {
            this.x = x; this.y = y; this.radius = 20; this.speed = 5; this.angle = 0;
        }
        update() {
            this.angle = Math.atan2(mouse.y - this.y, mouse.x - this.x);
            drawTurkAskeri(ctx, this.x, this.y, this.radius, this.angle);
            if (keys.w && this.y - this.radius > 0) this.y -= this.speed;
            if (keys.s && this.y + this.radius < canvas.height) this.y += this.speed;
            if (keys.a && this.x - this.radius > 0) this.x -= this.speed;
            if (keys.d && this.x + this.radius < canvas.width) this.x += this.speed;
        }
    }

    class Projectile {
        constructor(x, y, velocity) {
            this.x = x; this.y = y; this.radius = 3; this.color = 'yellow'; this.velocity = velocity;
        }
        update() {
            ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
            ctx.fillStyle = this.color; ctx.fill();
            this.x += this.velocity.x; this.y += this.velocity.y;
        }
    }

    class Enemy {
        constructor(x, y) {
            this.x = x; this.y = y; this.radius = 20; 
            this.speed = Math.random() * (2.5 - 1) + 1; this.angle = 0;
        }
        update() {
            this.angle = Math.atan2(player.y - this.y, player.x - this.x);
            drawDusmanAskeri(ctx, this.x, this.y, this.radius, this.angle);
            const velocity = { x: Math.cos(this.angle) * this.speed, y: Math.sin(this.angle) * this.speed };
            this.x += velocity.x; this.y += velocity.y;
        }
    }

    let player = new Player(canvas.width / 2, canvas.height / 2);
    let projectiles = [];
    let enemies = [];
    let enemySpawnInterval;

    const keys = { w: false, s: false, a: false, d: false };
    const mouse = { x: canvas.width / 2, y: canvas.height / 2 };

    window.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'w') keys.w = true;
        if (e.key.toLowerCase() === 's') keys.s = true;
        if (e.key.toLowerCase() === 'a') keys.a = true;
        if (e.key.toLowerCase() === 'd') keys.d = true;
    });
    window.addEventListener('keyup', (e) => {
        if (e.key.toLowerCase() === 'w') keys.w = false;
        if (e.key.toLowerCase() === 's') keys.s = false;
        if (e.key.toLowerCase() === 'a') keys.a = false;
        if (e.key.toLowerCase() === 'd') keys.d = false;
    });
    window.addEventListener('mousemove', (e) => {
        const rect = canvas.getBoundingClientRect();
        mouse.x = e.clientX - rect.left; mouse.y = e.clientY - rect.top;
    });
    window.addEventListener('click', () => {
        if (!gameRunning) return;
        const angle = Math.atan2(mouse.y - player.y, mouse.x - player.x);
        const velocity = { x: Math.cos(angle) * 15, y: Math.sin(angle) * 15 };
        const spawnX = player.x + Math.cos(angle) * 20;
        const spawnY = player.y + Math.sin(angle) * 20;
        projectiles.push(new Projectile(spawnX, spawnY, velocity));
    });

    function spawnEnemies() {
        enemySpawnInterval = setInterval(() => {
            if (!gameRunning) return;
            const radius = 20;
            let x, y;
            if (Math.random() < 0.5) {
                x = Math.random() < 0.5 ? 0 - radius : canvas.width + radius;
                y = Math.random() * canvas.height;
            } else {
                x = Math.random() * canvas.width;
                y = Math.random() < 0.5 ? 0 - radius : canvas.height + radius;
            }
            enemies.push(new Enemy(x, y));
        }, 1200);
    }

    function animate() {
        if (!gameRunning) return;
        animationId = requestAnimationFrame(animate);
        ctx.fillStyle = '#d7ccc8'; ctx.fillRect(0, 0, canvas.width, canvas.height);
        player.update();

        projectiles.forEach((projectile, index) => {
            projectile.update();
            if (projectile.x < 0 || projectile.x > canvas.width || projectile.y < 0 || projectile.y > canvas.height) {
                projectiles.splice(index, 1);
            }
        });

        enemies.forEach((enemy, index) => {
            enemy.update();
            const distPlayer = Math.hypot(player.x - enemy.x, player.y - enemy.y);
            if (distPlayer - enemy.radius - player.radius < -10) endGame();

            projectiles.forEach((projectile, pIndex) => {
                const dist = Math.hypot(projectile.x - enemy.x, projectile.y - enemy.y);
                if (dist - enemy.radius - projectile.radius < 1) {
                    score++; scoreEl.innerText = score;
                    setTimeout(() => { enemies.splice(index, 1); projectiles.splice(pIndex, 1); }, 0);
                }
            });
        });
    }

    function startGame() {
        startScreen.style.display = 'none';
        gameOverScreen.style.display = 'none';
        gameRunning = true;
        score = 0;
        scoreEl.innerText = score;

        // Spotify oynatÄ±cÄ±yÄ± gÃ¶ster
        spotifyPlayer.style.display = 'block';

        animate();
        spawnEnemies();
    }

    function endGame() {
        gameRunning = false;
        cancelAnimationFrame(animationId);
        clearInterval(enemySpawnInterval);
        gameOverScreen.style.display = 'block';
        finalScoreEl.innerText = score;
        spotifyPlayer.style.display = 'none';
    }

    function restartGame() {
        projectiles = [];
        enemies = [];
        player.x = canvas.width / 2;
        player.y = canvas.height / 2;
        startGame();
    }

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth - 20;
        canvas.height = window.innerHeight - 20;
    });
</script>
</body>
</html>

